!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.vmStorage=e():t.vmStorage=e()}(this,function(){return function(t){function e(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,o){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(t){return"string"==typeof t},a=function(t){return void 0!==t&&null!==t},u=function(t){return void 0===t||null===t||""===t},c=function(t){return"object"===(void 0===t?"undefined":i(t))},f=function(t){return c(t)&&Object.getPrototypeOf(t)===Object.prototype},h=Array.isArray,l=function(t){try{return JSON.parse(t)}catch(e){return t}},p=JSON.stringify,d=function(){function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o(this,t),this._version="0.2.0",this._catch={},this._prefix="vmStorage-",this._storage=null,this._prefixLength=null,this._storageType=e,a(n.prefix)&&(this._prefix=n.prefix.toString().trim()),"_"===this._prefix.charAt(0))return void console.error('The vm-storage prefix shoule not start with "_"!');if(this._prefixLength=this._prefix.length,this._storage=this._isStorageSupported(window,e),this.supported()){for(var i,s=0,u=this._storage.length;s<u;s++)if(i=this._storage.key(s),0!==i.indexOf("_")&&this._prefix===i.slice(0,this._prefixLength)){var c=l(this._storage.getItem(i));(h(c)||f(c))&&(this._catch[i.slice(this._prefixLength)]=c)}window.addEventListener&&window.addEventListener("storage",function(t){if(t.key){var e=window.document;e.hasFocus&&e.hasFocus()||r._prefix!==t.key.slice(0,r._prefixLength)||(t.newValue?r.set(t.key.slice(r._prefixLength),t.newValue):r.remove(t.key.slice(r._prefixLength)))}})}else console.warn("Current browser does not support "+this._storageType+", system will fallback to use memory to cache key/value data! storage.js::<Class>Storage")}return n(t,[{key:"get",value:function(t){return u(t)?this._catch:"_"===t.charAt(0)?(console.warn('get()::The key should not start with "_"!'),null):this._catch[t]}},{key:"set",value:function(t,e){if(s(t)&&!u(t)){if(u(e))return void this.remove(t);if("_"===t.charAt(0))return void console.warn('set()::The key should not start with "_"!');if(h(e)||f(e))this._catch[t]=e,this.supported()&&this._storage.setItem(this._prefix+t,p(e));else{if(!s(e))return console.error("$storage 必须存入object/array, 或者能序列化的string!"),!1;var r=l(e);if(!h(r)&&!f(r))return console.error("$storage 必须存入object/array, 或者能序列化的string!"),!1;this._catch[t]=r,this.supported()&&this._storage.setItem(this._prefix+t,e)}}}},{key:"clear",value:function(){for(var t in this._catch)"$"===t.charAt(0)||delete this._catch[t]&&this.supported()&&this._storage.removeItem(this._prefix+t)}},{key:"remove",value:function(t){if(!u(t)&&s(t))return"_"===t.charAt(0)?(console.warn('remove()::The key should not start with "_"!'),null):void(this.get(t)&&delete this._catch[t]&&this.supported()&&this._storage.removeItem(this._prefix+t))}},{key:"supported",value:function(){return!!this._storage}},{key:"_isStorageSupported",value:function(t,e){var r=void 0;try{r=t[e]}catch(t){r=!1}if(r){var o="__"+Math.round(1e7*Math.random());try{t[e].setItem(o,o),t[e].removeItem(o,o)}catch(t){r=!1}}return r}}]),t}(),y="undefined"!=typeof window,_=function t(e,r){t.installed||(Object.defineProperty(e.prototype,"$localStorage",{get:function(){return new d("localStorage",r)}}),Object.defineProperty(e.prototype,"$sessionStorage",{get:function(){return new d("sessionStorage",r)}}),t.installed=!0)},g={version:"0.2.0",install:_};y&&window.Vue&&window.Vue.use(g),t.exports=g}])});